knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
walesED <- read_excel("CancerIncidenceInWales_DataTables, 2002-2019_v2 (1).xlsx",
sheet = "Table 3 - Staging")
wales_17_19 <- walesED %>%
filter(Year == "2017-2019")
wales_17_19 <- wales_17_19 %>%
#filter(AGE > 34) %>%
mutate(ICD10 = case_when(`Cancer type` == "Lip, oral cavity and pharynx"
~ "C00-C14",
`Cancer type` == "Head & neck" ~ "C00-C14, C30-C32",
`Cancer type` == "Oesophagus" ~ "C15",
`Cancer type` == "Stomach" ~ "C16",
`Cancer type` == "Colon" ~ "C18",
`Cancer type` == "Colorectal" ~ "C18-C20",
`Cancer type` == "Rectum" ~ "C19-C20",
`Cancer type` == "Anus" ~ "C21",
`Cancer type` == "Liver" ~ "C22",
`Cancer type` == "Hepatocellular carcinoma" ~ "C220",
`Cancer type` == "Cholangiocarcinoma" ~ "C221",
`Cancer type` == "Pancreas" ~ "C25",
`Cancer type` == "Larynx" ~ "C32",
`Cancer type` == "Lung" ~ "C33-C34",
`Cancer type` == "Bone" ~ "C40-C41",
`Cancer type` == "Melanoma" ~ "C43",
`Cancer type` == "Mesothelioma" ~ "C45",
`Cancer type` == "Breast" ~ "C50",
`Cancer type` == "Female breast" ~ "C50",
`Cancer type` == "Cervix" ~ "C53",
`Cancer type` == "Uterus" ~ "C54",
`Cancer type` == "Ovary" ~ "C56",
`Cancer type` == "Prostate" ~ "C61",
`Cancer type` == "Testis" ~ "C62",
`Cancer type` == "Kidney" ~ "C64",
`Cancer type` == "Urinary tract excluding bladder"
~ "C64-C66,C68",
`Cancer type` == "Bladder" ~ "C67",
`Cancer type` == "Thyroid" ~ "C73",
`Cancer type` == "Hodgkin lymphoma" ~ "C81",
`Cancer type` == "Non-Hodgkin lymphoma" ~ "C82-C86",
`Cancer type` == "Myeloma" ~ "C90")) %>%
filter(Sex == "Persons")
sum(is.na(wales_17_19$ICD10))
#Filter to wales only
wales_only_17_19 <- wales_17_19 %>%
filter(Geography == "Wales")
#Filter out duplicate cancer types
wales_only_17_19 <- wales_only_17_19 %>%
filter(`Cancer type` != "Lip, oral cavity and pharynx",
`Cancer type` != "Colon",
`Cancer type` != "Rectum",
`Cancer type` != "Hepatocellular carcinoma",
`Cancer type` != "Cholangiocarcinoma",
`Cancer type` != "Larynx",
`Cancer type` != "Female breast",
`Cancer type` != "Kidney")
#Calculate the total number of diagnoses with KNOWN stage for each cancer type
total_cancer_cases <- wales_only_17_19 %>%
filter(Stage == "Unknown") %>%
mutate(`Total count` = `Total count` - Count) %>%
select(`Cancer type`, `Total count`)
#Calculate the total num
stage_1_2_count <- wales_only_17_19 %>%
filter(Stage == "1" | Stage == "2") %>%
group_by(`Cancer type`) %>%
summarise(stage_1_2 = sum(Count))
early_stage_diag <- merge(stage_1_2_count,
total_cancer_cases,
by = "Cancer type") %>%
mutate(proportion = stage_1_2 / `Total count`)
#Calculate the total number of cases diagnosed with KNOWN stage
diag_total = sum(early_stage_diag$`Total count`)
#Calculate the total number of stage 1 and 2 diagnoses
early_stage_diag_total = sum(early_stage_diag$stage_1_2)
#Calculate final proportion
proportion_early_diag = early_stage_diag_total / diag_total
proportion_early_diag
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
walesED <- read_excel("CancerIncidenceInWales_DataTables, 2002-2019_v2 (1).xlsx",
sheet = "Table 3 - Staging")
wales_17_19 <- walesED %>%
filter(Year == "2017-2019")
wales_17_19 <- wales_17_19 %>%
#filter(AGE > 34) %>%
mutate(ICD10 = case_when(`Cancer type` == "Lip, oral cavity and pharynx"
~ "C00-C14",
`Cancer type` == "Head & neck" ~ "C00-C14, C30-C32",
`Cancer type` == "Oesophagus" ~ "C15",
`Cancer type` == "Stomach" ~ "C16",
`Cancer type` == "Colon" ~ "C18",
`Cancer type` == "Colorectal" ~ "C18-C20",
`Cancer type` == "Rectum" ~ "C19-C20",
`Cancer type` == "Anus" ~ "C21",
`Cancer type` == "Liver" ~ "C22",
`Cancer type` == "Hepatocellular carcinoma" ~ "C220",
`Cancer type` == "Cholangiocarcinoma" ~ "C221",
`Cancer type` == "Pancreas" ~ "C25",
`Cancer type` == "Larynx" ~ "C32",
`Cancer type` == "Lung" ~ "C33-C34",
`Cancer type` == "Bone" ~ "C40-C41",
`Cancer type` == "Melanoma" ~ "C43",
`Cancer type` == "Mesothelioma" ~ "C45",
`Cancer type` == "Breast" ~ "C50",
`Cancer type` == "Female breast" ~ "C50",
`Cancer type` == "Cervix" ~ "C53",
`Cancer type` == "Uterus" ~ "C54",
`Cancer type` == "Ovary" ~ "C56",
`Cancer type` == "Prostate" ~ "C61",
`Cancer type` == "Testis" ~ "C62",
`Cancer type` == "Kidney" ~ "C64",
`Cancer type` == "Urinary tract excluding bladder"
~ "C64-C66,C68",
`Cancer type` == "Bladder" ~ "C67",
`Cancer type` == "Thyroid" ~ "C73",
`Cancer type` == "Hodgkin lymphoma" ~ "C81",
`Cancer type` == "Non-Hodgkin lymphoma" ~ "C82-C86",
`Cancer type` == "Myeloma" ~ "C90")) %>%
filter(Sex == "Persons")
sum(is.na(wales_17_19$ICD10))
#Filter to wales only
wales_only_17_19 <- wales_17_19 %>%
filter(Geography == "Wales")
#Filter out duplicate cancer types
wales_only_17_19 <- wales_only_17_19 %>%
filter(`Cancer type` != "Lip, oral cavity and pharynx",
`Cancer type` != "Colon",
`Cancer type` != "Rectum",
`Cancer type` != "Hepatocellular carcinoma",
`Cancer type` != "Cholangiocarcinoma",
`Cancer type` != "Larynx",
`Cancer type` != "Female breast",
`Cancer type` != "Kidney")
#Calculate the total number of diagnoses with KNOWN stage for each cancer type
total_cancer_cases <- wales_only_17_19 %>%
filter(Stage == "Unknown") %>%
mutate(`Total count` = `Total count` - Count) %>%
select(`Cancer type`, `Total count`)
#Calculate the total num
stage_1_2_count <- wales_only_17_19 %>%
filter(Stage == "1" | Stage == "2") %>%
group_by(`Cancer type`) %>%
summarise(stage_1_2 = sum(Count))
early_stage_diag <- merge(stage_1_2_count,
total_cancer_cases,
by = "Cancer type") %>%
mutate(proportion = stage_1_2 / `Total count`)
#Calculate the total number of cases diagnosed with KNOWN stage
diag_total = sum(early_stage_diag$`Total count`)
#Calculate the total number of stage 1 and 2 diagnoses
early_stage_diag_total = sum(early_stage_diag$stage_1_2)
#Calculate final proportion
proportion_early_diag = early_stage_diag_total / diag_total
proportion_early_diag
